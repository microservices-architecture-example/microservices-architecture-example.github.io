{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":""},{"location":"#microservices-architecture-example","title":"Microservices Architecture Example","text":"<p>A Cloud-Native E-Commerce Microservices Architecture built with Spring Boot and Kubernetes.</p> <p>This project is a practical and robust example of a microservices architecture, demonstrating how to build a scalable, resilient, and modern application. It serves as a reference for design patterns, system integration, and DevOps practices.</p>"},{"location":"#tech-stack","title":"\ud83d\ude80 Tech Stack","text":"<p>This project leverages a modern stack focused on performance, scalability, and cloud-native deployment:</p>"},{"location":"#backend-frameworks","title":"Backend &amp; Frameworks","text":""},{"location":"#data-persistence","title":"Data &amp; Persistence","text":""},{"location":"#devops-cloud","title":"DevOps &amp; Cloud","text":""},{"location":"#aws-integration","title":"\u2601\ufe0f AWS Integration","text":"<p>This architecture is designed to run natively on Amazon Web Services (AWS), leveraging managed services for high availability and minimal operational overhead.</p> <ul> <li>EKS (Elastic Kubernetes Service): Orchestrates the microservices containers.</li> <li>ALB/NLB (Load Balancers): Manages external traffic ingress to the API Gateway.</li> <li>RDS (Relational Database Service): (Optional) Can be configured to host the PostgreSQL databases.</li> <li>ElastiCache: (Optional) Managed Redis for caching.</li> </ul>"},{"location":"#architecture-design","title":"\ud83c\udfd7\ufe0f Architecture &amp; Design","text":"<p>The architecture follows the API Gateway pattern with isolated databases per service (Database per Service), ensuring decoupling and autonomy.</p>"},{"location":"#component-diagram","title":"Component Diagram","text":"<pre><code>flowchart LR\n    subgraph api [Subnet API]\n        direction TB\n        gateway --&gt; account\n        gateway --&gt; auth:::red\n        gateway --&gt; product\n        gateway --&gt; order\n        gateway --&gt; exchange\n        auth --&gt; account\n        order --&gt; product\n        account --&gt; db@{ shape: cyl, label: \"Database\" }\n        product --&gt; db\n        order --&gt; db\n    end\n    exchange e3@==&gt; 3partyapi:::green@{label: \"3rd-party API\"}\n    internet e2@==&gt; |request| gateway:::orange\n    e2@{ animate: true }\n    e3@{ animate: true }\n    classDef green fill:#cfc\n    classDef orange fill:#FCBE3E</code></pre>"},{"location":"#services","title":"Services","text":"<p>The system is composed of the following microservices, each with a unique responsibility:</p> Service Responsibility Interface Implementation Gateway Service Single entry point, routing, and security. - gateway-service Auth Service Authentication and authorization (JWT). auth auth-service Account Service User and account management. account account-service Product Service Product catalog and management. product product-service Order Service Order management and purchase flow. order order-service Exchange Service Currency exchange rates (external integration). - exchange-service"},{"location":"#key-features","title":"\ud83c\udf1f Key Features","text":"<ul> <li>Secure Authentication: Stateless implementation with JWT.</li> <li>Externalized Configuration: Centralized configuration management.</li> <li>Resilience: Fault tolerance patterns in inter-service communication.</li> <li>Automated CI/CD: Build and deploy pipelines with Jenkins.</li> <li>Infrastructure as Code: Organized Kubernetes manifests for EKS deployment.</li> </ul>"},{"location":"#main-repository","title":"\ud83d\udd17 Main Repository","text":"<p>To access the complete source code and service orchestration: microservices-architecture-example/all</p>"},{"location":"account/account/","title":"Account","text":""},{"location":"account/account/#account-service","title":"Account Service","text":"<p>The Account Service is the backbone of user management within the <code>store</code> domain. It handles user registration, authentication credentials, and profile management. It serves as the foundation for the authentication process and establishes relationships with other services (e.g., associating orders with users).</p> <p>Security &amp; Trusted Layer</p> <p>This service sits behind the API Gateway. *   External Access: All external requests must pass through the Gateway. *   Protection: Routes under <code>/account/**</code> are protected and require a valid JWT in the <code>Authorization</code> header (except for registration and login).</p>"},{"location":"account/account/#architecture","title":"\ud83c\udfd7\ufe0f Architecture","text":"<p>The service follows a clean layered architecture, separating the API interface from the core business logic and persistence.</p> <pre><code>classDiagram\n    namespace Interface_Layer {\n        class AccountController {\n            +create(AccountIn): AccountOut\n            +login(AccountIn): AccountOut\n            +findById(String): AccountOut\n        }\n        class AccountIn {\n            +String name\n            +String email\n            +String password\n        }\n        class AccountOut {\n            +String id\n            +String name\n            +String email\n            +Role role\n        }\n    }\n    namespace Core_Layer {\n        class AccountService {\n            +create(Account): Account\n            +findByEmailAndPassword(String, String): Account\n            -hash(String): String\n        }\n        class AccountRepository {\n            +save(AccountModel): AccountModel\n            +findByEmail(String): AccountModel\n        }\n    }\n\n    AccountController ..&gt; AccountIn : consumes\n    AccountController ..&gt; AccountOut : produces\n    AccountController --&gt; AccountService : delegates\n    AccountService --&gt; AccountRepository : persists</code></pre>"},{"location":"account/account/#api-reference","title":"\ud83d\udd0c API Reference","text":"<p>The service exposes a RESTful API for account management.</p>"},{"location":"account/account/#endpoints","title":"Endpoints","text":"Method Path Description Auth Required <code>POST</code> <code>/account</code> Register a new user account. \u274c No <code>POST</code> <code>/account/login</code> Authenticate user credentials. \u274c No <code>GET</code> <code>/account/{id}</code> Retrieve account details by ID. \u2705 Yes <code>GET</code> <code>/account</code> List all accounts (Admin use). \u2705 Yes <code>DELETE</code> <code>/account/{id}</code> Delete an account. \u2705 Yes <code>GET</code> <code>/account/whoami</code> Retrieve current user details based on headers. \u2705 Yes"},{"location":"account/account/#data-models","title":"Data Models","text":""},{"location":"account/account/#accountin-input","title":"<code>AccountIn</code> (Input)","text":"<p>Used for registration and login. </p><pre><code>{\n  \"name\": \"John Doe\",\n  \"email\": \"john@example.com\",\n  \"password\": \"secretpassword\"\n}\n</code></pre><p></p>"},{"location":"account/account/#accountout-output","title":"<code>AccountOut</code> (Output)","text":"<p>Safe representation of the user account (no sensitive data). </p><pre><code>{\n  \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"name\": \"John Doe\",\n  \"email\": \"john@example.com\",\n  \"role\": \"USER\"\n}\n</code></pre><p></p>"},{"location":"account/account/#business-logic","title":"\ud83e\udde0 Business Logic","text":"<p>The <code>AccountService</code> implements critical business rules to ensure data integrity and security.</p>"},{"location":"account/account/#1-validation","title":"1. Validation","text":"<ul> <li>Password: Must be at least 4 characters long (after trimming).</li> <li>Email: Mandatory and must be unique in the system.</li> <li>Role: New accounts are assigned the <code>USER</code> role by default.</li> </ul>"},{"location":"account/account/#2-security-password-hashing","title":"2. Security (Password Hashing)","text":"<p>Passwords are never stored in plain text. The service uses SHA-256 hashing before persistence.</p> <pre><code>// Snippet from AccountService.java\nprivate String hash(String pass) {\n    try {\n        MessageDigest digest = MessageDigest.getInstance(\"SHA-256\");\n        byte[] encodedHash = digest.digest(\n            pass.getBytes(StandardCharsets.UTF_8)\n        );\n        return Base64.getEncoder().encodeToString(encodedHash);\n    } catch (NoSuchAlgorithmException e) {\n        throw new ResponseStatusException(HttpStatus.INTERNAL_SERVER_ERROR, e.getMessage(), e);\n    }\n}\n</code></pre>"},{"location":"account/account/#database-schema","title":"\ud83d\udcbe Database Schema","text":"<p>The service uses PostgreSQL for persistence. Database migrations are managed by Flyway.</p>"},{"location":"account/account/#table-account","title":"Table: <code>account</code>","text":"Column Type Constraints Description <code>id</code> <code>VARCHAR</code> <code>PRIMARY KEY</code> Unique UUID. <code>name</code> <code>VARCHAR</code> <code>NOT NULL</code> User's full name. <code>email</code> <code>VARCHAR</code> <code>UNIQUE</code>, <code>NOT NULL</code> User's email address. <code>sha256</code> <code>VARCHAR</code> <code>NOT NULL</code> Hashed password. <code>role</code> <code>VARCHAR</code> <code>DEFAULT 'USER'</code> User role (USER, ADMIN)."},{"location":"account/account/#migrations","title":"Migrations","text":"<ul> <li><code>V2025.08.29.001__create_schema.sql</code>: Initializes the schema.</li> <li><code>V2025.08.29.002__create_table_account.sql</code>: Creates the account table.</li> <li><code>V2025.09.02.001__create_index_email.sql</code>: Adds index for fast email lookups.</li> </ul>"},{"location":"account/account/#configuration","title":"\u2699\ufe0f Configuration","text":"<p>The service is configured via <code>application.yml</code>. Key settings include:</p> <pre><code>spring:\n  application:\n    name: account\n  datasource:\n    url: ${DATABASE_URL} # Injected via environment variable\n    username: ${DATABASE_USER:store}\n    password: ${DATABASE_PASSWORD:I5pEr@5ecReT}\n  flyway:\n    baseline-on-migrate: true\n    schemas: account\n</code></pre>"},{"location":"account/account/#project-structure","title":"\ud83d\udcc2 Project Structure","text":"<p>The project is split into two modules:</p> <ol> <li>Interface (<code>account</code>): Contains the DTOs and Feign Client. This is a library used by other services to communicate with the Account Service.</li> <li>Implementation (<code>account.service</code>): The actual Spring Boot application.</li> </ol> <pre><code>\ud83d\udcc1 api/\n \u251c\u2500\u2500 account/                # Interface Module\n \u2502   \u251c\u2500\u2500 src/main/java/store/account/\n \u2502   \u2502   \u251c\u2500\u2500 AccountController.java  # Feign Client Interface\n \u2502   \u2502   \u251c\u2500\u2500 AccountIn.java          # Input DTO\n \u2502   \u2502   \u2514\u2500\u2500 AccountOut.java         # Output DTO\n \u2502   \u2514\u2500\u2500 pom.xml\n \u2502\n\ud83d\udcc1 \u2514\u2500\u2500 account.service/        # Implementation Module\n\u251c\u2500\u2500  \u251c\u2500\u2500 src/main/java/store/account/\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 AccountService.java     # Business Logic\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 AccountResource.java    # REST Controller Implementation\n\u251c\u2500\u2500  \u2502   \u2514\u2500\u2500 AccountRepository.java  # JPA Repository\n\u251c\u2500\u2500  \u251c\u2500\u2500 src/main/resources/\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 db/migration/           # Flyway SQL Scripts\n\u251c\u2500\u2500  \u2502   \u2514\u2500\u2500 application.yml         # Config\n\u251c\u2500\u2500  \u251c\u2500\u2500 Dockerfile\n\u2514\u2500\u2500  \u2514\u2500\u2500 k8s/                        # Kubernetes Manifests\n</code></pre>"},{"location":"auth/auth/","title":"Auth","text":""},{"location":"auth/auth/#auth-service","title":"Auth Service","text":"<p>The Auth Service is the security cornerstone of the <code>store</code> domain. It is responsible for validating user credentials and issuing JSON Web Tokens (JWT). These tokens are the \"keys\" that allow users to access protected resources across all other microservices.</p> <p>Security &amp; Trusted Layer</p> <ul> <li>Gateway Integration: The API Gateway delegates authentication to this service.</li> <li>Statelessness: The service is stateless; it does not store sessions. Trust is established via the cryptographic signature of the JWT.</li> </ul>"},{"location":"auth/auth/#architecture","title":"\ud83c\udfd7\ufe0f Architecture","text":"<p>The service orchestrates the login flow by verifying credentials against the Account Service and then using its internal JWT Service to sign tokens.</p> <pre><code>classDiagram\n    namespace Interface_Layer {\n        class AuthController {\n            +login(LoginIn): TokenOut\n            +register(RegisterIn): TokenOut\n            +solve(TokenOut): Map\n        }\n    }\n    namespace Core_Layer {\n        class AuthService {\n            +login(String, String): String\n            +register(String, String, String): String\n        }\n        class JwtService {\n            +generate(AccountOut): String\n            +getClaims(String): Claims\n            -getKey(): SecretKey\n        }\n    }\n    namespace External_Integration {\n        class AccountClient {\n            +findByEmailAndPassword(LoginIn): AccountOut\n            +create(AccountIn): AccountOut\n        }\n    }\n\n    AuthController --&gt; AuthService : delegates\n    AuthService --&gt; AccountClient : verifies credentials\n    AuthService --&gt; JwtService : requests token</code></pre>"},{"location":"auth/auth/#api-reference","title":"\ud83d\udd0c API Reference","text":"<p>The API is primarily used for obtaining access tokens.</p>"},{"location":"auth/auth/#endpoints","title":"Endpoints","text":"Method Path Description Auth Required <code>POST</code> <code>/auth/login</code> Authenticate with email/password and receive a JWT. \u274c No <code>POST</code> <code>/auth/register</code> Create a new account and receive a JWT (Proxy to Account Service). \u274c No <code>POST</code> <code>/auth/solve</code> Validate a token and extract claims (Internal use). \u274c No"},{"location":"auth/auth/#data-models","title":"Data Models","text":""},{"location":"auth/auth/#loginin","title":"<code>LoginIn</code>","text":"<pre><code>{\n  \"email\": \"john@example.com\",\n  \"password\": \"secretpassword\"\n}\n</code></pre>"},{"location":"auth/auth/#tokenout","title":"<code>TokenOut</code>","text":"<pre><code>{\n  \"token\": \"eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJKb2huIERvZSIsIm...\"\n}\n</code></pre>"},{"location":"auth/auth/#security-flow","title":"\ud83d\udd10 Security Flow","text":"<p>The authentication process involves a secure handshake between the Auth Service and the Account Service.</p> <pre><code>sequenceDiagram\n    participant Client\n    participant Auth as Auth Service\n    participant Account as Account Service\n    participant JWT as JWT Service\n\n    Client-&gt;&gt;Auth: POST /login (email, password)\n    Auth-&gt;&gt;Account: POST /account/login (email, password)\n\n    alt Credentials Valid\n        Account--&gt;&gt;Auth: 200 OK (Account Details + Role)\n        Auth-&gt;&gt;JWT: generate(Account)\n        JWT--&gt;&gt;Auth: Signed Token (HS256)\n        Auth--&gt;&gt;Client: 200 OK (Token)\n    else Invalid\n        Account--&gt;&gt;Auth: 404/401\n        Auth--&gt;&gt;Client: 401 Unauthorized\n    end</code></pre>"},{"location":"auth/auth/#jwt-implementation-details","title":"\ud83d\udd11 JWT Implementation Details","text":"<p>The <code>JwtService</code> handles the cryptographic operations.</p>"},{"location":"auth/auth/#configuration","title":"Configuration","text":"<ul> <li>Algorithm: <code>HMAC256</code> (HS256).</li> <li>Expiration: 2 hours (120 minutes).</li> <li>Issuer: <code>Luigi::Carmona</code>.</li> </ul>"},{"location":"auth/auth/#token-structure-claims","title":"Token Structure (Claims)","text":"<p>The generated token contains the following claims:</p> Claim Key Description Subject <code>sub</code> User's Name. ID <code>jti</code> User's UUID (from Account Service). Issuer <code>iss</code> <code>Luigi::Carmona</code>. Role <code>role</code> User's Role (e.g., <code>USER</code>, <code>ADMIN</code>). Email <code>email</code> User's Email."},{"location":"auth/auth/#code-snippet-token-generation","title":"Code Snippet: Token Generation","text":"<pre><code>// Snippet from JwtService.java\npublic String generate(AccountOut account) {\n    Date now = new Date();\n    return Jwts.builder()\n        .header().and()\n        .id(account.id())\n        .issuer(\"Luigi::Carmona\")\n        .claims(Map.of(\n            \"email\", account.email(),\n            \"role\", account.role()\n        ))\n        .signWith(getKey()) // HMAC-SHA Key\n        .subject(account.name())\n        .notBefore(now)\n        .expiration(new Date(now.getTime() + 1000 * 60 * 120)) // 2 hours\n        .compact();\n}\n</code></pre>"},{"location":"auth/auth/#configuration_1","title":"\u2699\ufe0f Configuration","text":"<p>The service is configured via <code>application.yaml</code>.</p> <pre><code>store:\n  jwt:\n    # The secret key used to sign tokens. \n    # In production, this is injected via environment variables.\n    secretKey: ${JWT_SECRET_KEY:changeit}\n</code></pre>"},{"location":"auth/auth/#project-structure","title":"\ud83d\udcc2 Project Structure","text":"<p>The project follows the standard Interface/Implementation split:</p> <ol> <li>Interface (<code>auth</code>): Contains DTOs and the Feign Client interface.</li> <li>Implementation (<code>auth.service</code>): The Spring Boot application containing the logic.</li> </ol> <pre><code>\ud83d\udcc1 api/\n \u251c\u2500\u2500 auth/                   # Interface Module\n \u2502   \u251c\u2500\u2500 src/main/java/store/auth/\n \u2502   \u2502   \u251c\u2500\u2500 AuthController.java     # Feign Interface\n \u2502   \u2502   \u251c\u2500\u2500 LoginIn.java            # DTO\n \u2502   \u2502   \u251c\u2500\u2500 RegisterIn.java         # DTO\n \u2502   \u2502   \u2514\u2500\u2500 TokenOut.java           # DTO\n \u2502   \u2514\u2500\u2500 pom.xml\n \u2502\n\ud83d\udcc1 \u2514\u2500\u2500 auth.service/           # Implementation Module\n\u251c\u2500\u2500  \u251c\u2500\u2500 src/main/java/store/auth/\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 AuthService.java        # Orchestration Logic\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 JwtService.java         # JWT Signing/Parsing\n\u251c\u2500\u2500  \u2502   \u2514\u2500\u2500 AuthResource.java       # REST Controller\n\u251c\u2500\u2500  \u251c\u2500\u2500 src/main/resources/\n\u251c\u2500\u2500  \u2502   \u2514\u2500\u2500 application.yaml        # Config\n\u251c\u2500\u2500  \u251c\u2500\u2500 Dockerfile\n\u2514\u2500\u2500  \u2514\u2500\u2500 k8s/                        # Kubernetes Manifests\n</code></pre>"},{"location":"exchange/exchange/","title":"Exchange","text":""},{"location":"exchange/exchange/#exchange-service","title":"Exchange Service","text":"<p>The Exchange Service provides real-time currency conversion rates for the <code>store</code> domain. Unlike other services in this architecture which are built with Java/Spring Boot, this service is implemented using Python and FastAPI, demonstrating the polyglot nature of the microservices architecture.</p> <p>Polyglot Architecture</p> <p>This service showcases how different technologies can coexist in the same ecosystem, communicating via standard REST APIs.</p>"},{"location":"exchange/exchange/#architecture","title":"\ud83c\udfd7\ufe0f Architecture","text":"<p>The service acts as a proxy to external currency providers, adding a business layer (spread application) on top of the raw rates.</p> <pre><code>classDiagram\n    class ExchangeService {\n        +get_exchange_rate(base, target): ExchangeResponse\n    }\n\n    class RatesClient {\n        +get_rate(base): dict\n    }\n\n    class ExchangeResponse {\n        +str base\n        +str target\n        +float rate\n        +float buy\n        +float sell\n    }\n\n    ExchangeService --&gt; RatesClient : fetches raw data\n    RatesClient ..&gt; External_API : https://open.er-api.com</code></pre>"},{"location":"exchange/exchange/#api-reference","title":"\ud83d\udd0c API Reference","text":""},{"location":"exchange/exchange/#endpoints","title":"Endpoints","text":"Method Path Description Auth Required <code>GET</code> <code>/exchange/{base}/{target}</code> Get the exchange rate between two currencies. \u2705 Yes"},{"location":"exchange/exchange/#data-models","title":"Data Models","text":""},{"location":"exchange/exchange/#exchangeresponse","title":"<code>ExchangeResponse</code>","text":"<pre><code>{\n  \"base\": \"USD\",\n  \"target\": \"BRL\",\n  \"rate\": 5.15,\n  \"buy\": 5.253,\n  \"sell\": 5.047\n}\n</code></pre>"},{"location":"exchange/exchange/#business-logic","title":"\ud83e\udde0 Business Logic","text":"<p>The core logic involves fetching the market rate and applying a configurable spread to determine the \"Buy\" and \"Sell\" prices for the store.</p>"},{"location":"exchange/exchange/#1-external-integration","title":"1. External Integration","text":"<p>The service queries <code>https://open.er-api.com/v6/latest/{CURRENCY}</code> to get the latest market rates.</p>"},{"location":"exchange/exchange/#2-spread-calculation","title":"2. Spread Calculation","text":"<p>A spread (profit margin) is applied to the market rate. *   Buy Rate: <code>Market Rate * (1 + Spread)</code> *   Sell Rate: <code>Market Rate * (1 - Spread)</code></p> <pre><code># Snippet from rates.py\nrate = data[\"rates\"][target.upper()]\nspread = settings.spread  # e.g., 0.02 (2%)\n\nreturn {\n    \"base\": base.upper(),\n    \"target\": target.upper(),\n    \"rate\": rate,\n    \"buy\": round(rate * (1 + spread), 6),\n    \"sell\": round(rate * (1 - spread), 6),\n}\n</code></pre>"},{"location":"exchange/exchange/#configuration","title":"\u2699\ufe0f Configuration","text":"<p>The service uses Pydantic for configuration management, reading from environment variables.</p> <pre><code># config.py\nclass Settings(BaseSettings):\n    port: int = 8083\n    rates_base_url: str = \"https://open.er-api.com\"\n    spread: float = 0.02  # 2% Spread\n    jwt_algorithm: str = \"HS256\"\n</code></pre>"},{"location":"exchange/exchange/#project-structure","title":"\ud83d\udcc2 Project Structure","text":"<p>The project follows a standard Python/FastAPI structure.</p> <pre><code>\ud83d\udcc1 api/\n\ud83d\udcc1 \u2514\u2500\u2500 exchange.service/\n\u251c\u2500\u2500  \u251c\u2500\u2500 app/\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 main.py             # FastAPI Application\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 auth.py             # JWT Validation\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 config.py           # Settings\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 models.py           # Pydantic Models\n\u251c\u2500\u2500  \u2502   \u2514\u2500\u2500 rates.py            # Business Logic\n\u251c\u2500\u2500  \u251c\u2500\u2500 requirements.txt        # Python Dependencies\n\u251c\u2500\u2500  \u251c\u2500\u2500 Dockerfile\n\u2514\u2500\u2500  \u2514\u2500\u2500 k8s/                    # Kubernetes Manifests\n</code></pre>"},{"location":"gateway/gateway/","title":"Gateway","text":""},{"location":"gateway/gateway/#gateway-service","title":"Gateway Service","text":"<p>The Gateway Service acts as the single entry point (Edge Server) for all external traffic entering the <code>store</code> domain. It is built on top of Spring Cloud Gateway and provides routing, security, and monitoring capabilities.</p> <p>Edge Server &amp; Security</p> <ul> <li>Single Entry Point: Clients only interact with the Gateway, never directly with internal microservices.</li> <li>Security Enforcement: It enforces authentication via JWT validation before routing requests to protected services.</li> </ul>"},{"location":"gateway/gateway/#architecture","title":"\ud83c\udfd7\ufe0f Architecture","text":"<p>The Gateway orchestrates the request flow through a series of filters.</p> <pre><code>classDiagram\n    class GatewayApplication {\n        +main(String[] args)\n    }\n\n    class Security_Components {\n        &lt;&lt;Filter&gt;&gt;\n        AuthorizationFilter\n        CorsFilter\n        RouterValidator\n    }\n\n    class AuthorizationFilter {\n        +filter(exchange, chain): Mono&lt;Void&gt;\n        -isSecured(request): boolean\n        -validateToken(token): Claims\n    }\n\n    class RouterValidator {\n        +isSecured(request): boolean\n    }\n\n    class CorsFilter {\n        +corsWebFilter(): CorsWebFilter\n    }\n\n    GatewayApplication --&gt; Security_Components\n    AuthorizationFilter ..&gt; RouterValidator : uses</code></pre>"},{"location":"gateway/gateway/#routing-configuration","title":"\ud83d\udea6 Routing Configuration","text":"<p>Routes are defined in <code>application.yml</code>. The Gateway uses the <code>http://</code> protocol to route traffic to specific hostnames (which resolve to Kubernetes Services or Docker containers).</p> <pre><code>spring:\n  cloud:\n    gateway:\n      routes:\n        - id: auth\n          uri: http://auth:8080\n          predicates:\n            - Path=/auth/**\n\n        - id: account\n          uri: http://account:8080\n          predicates:\n            - Path=/account/**\n\n        - id: order\n          uri: http://order:8080\n          predicates:\n            - Path=/order/**\n</code></pre>"},{"location":"gateway/gateway/#security-pipeline","title":"\ud83d\udd10 Security Pipeline","text":"<p>The Gateway implements a robust security pipeline to protect downstream services.</p>"},{"location":"gateway/gateway/#1-cors-configuration-corsfilter","title":"1. CORS Configuration (<code>CorsFilter</code>)","text":"<p>Handles Cross-Origin Resource Sharing to allow web clients to interact with the API. *   Allowed Origins: <code>*</code> (All origins). *   Allowed Methods: <code>*</code> (GET, POST, PUT, DELETE, etc.).</p>"},{"location":"gateway/gateway/#2-route-validation-routervalidator","title":"2. Route Validation (<code>RouterValidator</code>)","text":"<p>Determines if a request requires authentication. *   Public Endpoints:     *   <code>/auth/login</code>     *   <code>/auth/register</code>     *   <code>/auth/swagger-ui.html</code> *   Protected Endpoints: All others.</p>"},{"location":"gateway/gateway/#3-authorization-authorizationfilter","title":"3. Authorization (<code>AuthorizationFilter</code>)","text":"<p>This is the core security filter that executes for every protected request.</p>"},{"location":"gateway/gateway/#logic-flow","title":"Logic Flow:","text":"<ol> <li>Check Header: Verifies the presence of the <code>Authorization</code> header.</li> <li>Extract Token: Parses the <code>Bearer &lt;token&gt;</code> string.</li> <li>Validate Token: Calls the Auth Service (<code>/auth/solve</code>) to validate the signature and expiration.</li> <li>Inject Identity: If valid, it injects the <code>id-account</code> and <code>role-account</code> headers into the request.</li> <li>Forward: Passes the modified request to the downstream service.</li> </ol> <pre><code>// Snippet from AuthorizationFilter.java\nprivate Mono&lt;Void&gt; requestAuthTokenSolve(ServerWebExchange exchange, GatewayFilterChain chain, String jwt) {\n    return webClient\n        .post()\n        .uri(\"http://auth:8080/auth/solve\")\n        .bodyValue(Map.of(\"jwt\", jwt))\n        .retrieve()\n        .toEntity(Map.class)\n        .flatMap(response -&gt; {\n            // ... extract accountId and role ...\n            ServerWebExchange authorizated = updateRequest(exchange, accountId, role);\n            return chain.filter(authorizated);\n        });\n}\n</code></pre>"},{"location":"gateway/gateway/#request-flow","title":"\ud83d\udd04 Request Flow","text":"<p>The following sequence diagram illustrates the lifecycle of a request entering the Gateway.</p> <pre><code>sequenceDiagram\n    participant Client\n    participant Gateway\n    participant Auth as Auth Service\n    participant Downstream as Target Service\n\n    Client-&gt;&gt;Gateway: GET /account/me (Header: Bearer JWT)\n\n    Gateway-&gt;&gt;Gateway: RouterValidator.isSecured()\n\n    alt is Secured\n        Gateway-&gt;&gt;Auth: POST /auth/solve (JWT)\n        alt Token Valid\n            Auth--&gt;&gt;Gateway: 200 OK (id, role)\n            Gateway-&gt;&gt;Gateway: Inject headers (id-account, role)\n            Gateway-&gt;&gt;Downstream: GET /account/me (Header: id-account)\n            Downstream--&gt;&gt;Gateway: 200 OK (Response)\n            Gateway--&gt;&gt;Client: 200 OK (Response)\n        else Token Invalid\n            Auth--&gt;&gt;Gateway: 401 Unauthorized\n            Gateway--&gt;&gt;Client: 401 Unauthorized\n        end\n    else is Public\n        Gateway-&gt;&gt;Downstream: Forward Request\n    end</code></pre>"},{"location":"gateway/gateway/#configuration","title":"\u2699\ufe0f Configuration","text":"<p>The service is configured via <code>application.yml</code>.</p> <pre><code>server:\n  port: 8080\n\nspring:\n  application:\n    name: gateway\n  cloud:\n    gateway:\n      routes: [ ... ] # Route definitions\n\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: [ 'prometheus', 'gateway' ] # Monitoring\n</code></pre>"},{"location":"gateway/gateway/#project-structure","title":"\ud83d\udcc2 Project Structure","text":"<p>The project structure is focused on the Spring Cloud Gateway implementation.</p> <pre><code>\ud83d\udcc1 api/\n\ud83d\udcc1 \u2514\u2500\u2500 gateway.service/\n\u251c\u2500\u2500  \u251c\u2500\u2500 src/main/java/store/gateway/\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 GatewayApplication.java     # Main Entry Point\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 GatewayResource.java        # Health Check\n\u251c\u2500\u2500  \u2502   \u2514\u2500\u2500 security/\n\u251c\u2500\u2500  \u2502       \u251c\u2500\u2500 AuthorizationFilter.java # JWT Validation Logic\n\u251c\u2500\u2500  \u2502       \u251c\u2500\u2500 CorsFilter.java          # CORS Config\n\u251c\u2500\u2500  \u2502       \u2514\u2500\u2500 RouterValidator.java     # Route Security Rules\n\u251c\u2500\u2500  \u251c\u2500\u2500 src/main/resources/\n\u251c\u2500\u2500  \u2502   \u2514\u2500\u2500 application.yaml            # Routes &amp; Config\n\u251c\u2500\u2500  \u251c\u2500\u2500 Dockerfile\n\u2514\u2500\u2500  \u2514\u2500\u2500 k8s/                            # Kubernetes Manifests\n</code></pre>"},{"location":"jenkins/jenkins/","title":"Jenkins Pipelines","text":""},{"location":"jenkins/jenkins/#jenkins-cicd-pipelines","title":"Jenkins CI/CD Pipelines","text":"<p>The project's Continuous Integration and Continuous Deployment (CI/CD) workflow is orchestrated by Jenkins. The pipelines are designed to ensure code quality, automate testing, and streamline the delivery of Docker images to the registry.</p>"},{"location":"jenkins/jenkins/#pipeline-strategy","title":"\ud83d\ude80 Pipeline Strategy","text":"<p>There are two distinct pipeline types tailored to the component architecture:</p>"},{"location":"jenkins/jenkins/#1-interface-pipelines","title":"1. Interface Pipelines","text":"<p>(Applied to: <code>account</code>, <code>auth</code>, <code>product</code>, <code>order</code>) *   Goal: Publish shared artifacts (JARs/Contracts) for other modules to consume. *   Output: Maven Artifacts (installed to local/remote repo). *   Steps: <code>mvn clean install</code> (skipping tests for speed in this demo context). *   Docker: \u274c No image generation.</p>"},{"location":"jenkins/jenkins/#2-service-pipelines","title":"2. Service Pipelines","text":"<p>(Applied to: <code>*.service</code> modules) *   Goal: Deployable application artifacts. *   Output: Multi-architecture Docker Images (<code>linux/amd64</code>, <code>linux/arm64</code>). *   Steps:     1.  Dependencies: Trigger upstream Interface jobs to ensure contracts are up-to-date.     2.  Build: Compile the application (<code>mvn package</code>).     3.  Docker Build &amp; Push: Build and push images to Docker Hub using <code>buildx</code>.</p>"},{"location":"jenkins/jenkins/#build-status","title":"\ud83d\udcca Build Status","text":"<p>The Jenkins dashboard provides a centralized view of all active pipelines, their health, and execution history.</p> <p></p>"},{"location":"jenkins/jenkins/#pipeline-definitions","title":"\ud83d\udee0\ufe0f Pipeline Definitions","text":""},{"location":"jenkins/jenkins/#interface-pipeline-maven-only","title":"Interface Pipeline (Maven Only)","text":"<p>Simple pipeline to compile and install the artifact.</p> <pre><code>pipeline {\n    agent any\n    stages {\n        stage('Build') {\n            steps {\n                sh 'mvn -B -DskipTests clean install'\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"jenkins/jenkins/#service-pipeline-docker-build-push","title":"Service Pipeline (Docker Build &amp; Push)","text":"<p>Comprehensive pipeline handling dependencies, build, and multi-arch image publication.</p> <pre><code>pipeline {\n    agent any\n    environment {\n        SERVICE = \"account-service\" // Example\n        NAME = \"microservices-architecture-example/${env.SERVICE}\"\n    }\n    stages {\n        stage('Dependencies') {\n            steps {\n                // Ensure the Interface contract is built first\n                build job: 'account', wait: true\n            }\n        }\n        stage('Build') { \n            steps {\n                sh 'mvn -B -DskipTests clean package'\n            }\n        }      \n        stage('Build &amp; Push Image') {\n            steps {\n                withCredentials([usernamePassword(\n                    credentialsId: 'dockerhub-credential',\n                    usernameVariable: 'USERNAME',\n                    passwordVariable: 'TOKEN')]) {\n\n                    sh \"docker login -u $USERNAME -p $TOKEN\"\n\n                    // Create ephemeral multi-arch builder\n                    sh \"docker buildx create --use --platform=linux/arm64,linux/amd64 --name builder-${env.SERVICE}\"\n\n                    // Build and Push tags: :latest and :BUILD_ID\n                    sh \"docker buildx build --platform=linux/arm64,linux/amd64 --push --tag ${env.NAME}:latest --tag ${env.NAME}:${env.BUILD_ID} -f Dockerfile .\"\n\n                    // Cleanup\n                    sh \"docker buildx rm --force builder-${env.SERVICE}\"\n                }\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"jenkins/jenkins/#workflow-diagram","title":"\ud83d\udd04 Workflow Diagram","text":"<pre><code>flowchart TB\n    subgraph Jenkins\n        I[Interface Job\\nmvn clean install] --&gt;|Artifact| S[Service Job\\nmvn package]\n        S --&gt; D[Docker Buildx\\nBuild &amp; Push]\n    end\n    D --&gt; REG[(Docker Hub)]\n    REG --&gt;|Pull| K8S[Kubernetes Cluster]</code></pre>"},{"location":"jenkins/jenkins/#jenkinsfile-locations","title":"\ud83d\udcc2 Jenkinsfile Locations","text":"<p>The <code>Jenkinsfile</code> for each component is located in its respective source repository. You can view the specific configuration in the API documentation:</p> Component Documentation Account Account API Auth Auth API Gateway Gateway API Product Product API Order Order API Exchange Exchange API"},{"location":"jenkins/jenkins/#operational-notes","title":"\u2699\ufe0f Operational Notes","text":"<ul> <li>Credentials: Docker Hub access is managed via the <code>dockerhub-credential</code> secret in Jenkins.</li> <li>Multi-Architecture: We use <code>docker buildx</code> to support both x86 (AMD64) and ARM64 architectures, ensuring compatibility with various cloud instances and local development machines (e.g., Apple Silicon).</li> <li>Dependency Management: The <code>build job: ..., wait: true</code> step ensures that changes in the Interface module are immediately reflected in the Service build.</li> </ul>"},{"location":"k8s/kubernetes/","title":"Kubernetes","text":""},{"location":"k8s/kubernetes/#kubernetes-deployment","title":"Kubernetes Deployment","text":"<p>The store's infrastructure is orchestrated using Amazon EKS (Elastic Kubernetes Service), ensuring high availability, scalability, and robust management of microservices.</p>"},{"location":"k8s/kubernetes/#deployment-strategy","title":"\ud83c\udfd7\ufe0f Deployment Strategy","text":"<p>The architecture is divided into distinct components, each with a specific deployment strategy tailored to its role.</p>"},{"location":"k8s/kubernetes/#1-database-postgresql","title":"1. Database (PostgreSQL)","text":"<ul> <li>Type: Stateful Component.</li> <li>Deployment: Single replica Deployment (for this example environment).</li> <li>Configuration: Managed via <code>ConfigMap</code> (non-sensitive data) and <code>Secret</code> (credentials).</li> <li>Exposure: Internal <code>ClusterIP</code> service, accessible only within the cluster.</li> </ul>"},{"location":"k8s/kubernetes/#2-domain-services","title":"2. Domain Services","text":"<p>(Account, Auth, Product, Order, Exchange) *   Type: Stateless Microservices. *   Deployment: Independent Deployments for each service. *   Exposure: Internal <code>ClusterIP</code> services. *   Communication: Services communicate via internal DNS (<code>service-name.namespace.svc.cluster.local</code>).</p>"},{"location":"k8s/kubernetes/#3-api-gateway","title":"3. API Gateway","text":"<ul> <li>Type: Edge Server.</li> <li>Exposure: External <code>LoadBalancer</code> (AWS ALB/NLB).</li> <li>Role: Single entry point for all external traffic, handling routing and security.</li> </ul>"},{"location":"k8s/kubernetes/#cluster-status-eks","title":"\ud83d\udcca Cluster Status (EKS)","text":"<p>The following dashboards provide real-time insights into the cluster's health and resource consumption.</p>"},{"location":"k8s/kubernetes/#cluster-overview","title":"Cluster Overview","text":""},{"location":"k8s/kubernetes/#cost-analysis","title":"Cost Analysis","text":"<p>Summary </p> <p>Breakdown by Service </p>"},{"location":"k8s/kubernetes/#deployment-demo","title":"\ud83c\udfa5 Deployment Demo","text":"Your browser does not support the video tag."},{"location":"k8s/kubernetes/#architecture-diagram","title":"\ud83d\uddfa\ufe0f Architecture Diagram","text":"<pre><code>flowchart TB\n    subgraph AWS_EKS[\"EKS Cluster (namespace: store)\"]\n        DB[(Postgres Service\\nClusterIP)]\n        GW[\"Gateway (LoadBalancer)\"]\n        ACC[\"Account-Service\"]\n        AUTH[\"Auth-Service\"]\n        ORD[\"Order-Service\"]\n        PROD[\"Product-Service\"]\n        EXC[\"Exchange-Service\"]\n\n        GW --&gt; AUTH\n        GW --&gt; ACC\n        GW --&gt; ORD\n        GW --&gt; PROD\n        GW --&gt; EXC\n\n        ACC --&gt; DB\n        AUTH --&gt; DB\n        ORD --&gt; DB\n        PROD --&gt; DB\n    end\n\n    EXT[Internet Client]\n    3PP[External Rates API]\n\n    EXT --&gt; GW\n    EXC --&gt; 3PP</code></pre>"},{"location":"k8s/kubernetes/#manifest-locations","title":"\ud83d\udcc2 Manifest Locations","text":"<p>Kubernetes manifests are co-located with their respective service source code in the <code>k8s/</code> directory:</p> <ul> <li>Account API</li> <li>Auth API</li> <li>Gateway API</li> <li>Product API</li> <li>Order API</li> </ul>"},{"location":"k8s/kubernetes/#deployment-commands","title":"\ud83d\udee0\ufe0f Deployment Commands","text":"<p>Deployments are applied using standard <code>kubectl</code> commands.</p>"},{"location":"k8s/kubernetes/#1-database-setup-postgresql","title":"1\ufe0f\u20e3 Database Setup (PostgreSQL)","text":"<p>The database must be deployed first to ensure services can connect upon startup.</p> <pre><code># 1. Apply Secrets (Credentials)\nkubectl apply -f ./k8s/secrets.yaml\n\n# 2. Apply ConfigMap (DB Name, Settings)\nkubectl apply -f ./k8s/configmap.yaml\n\n# 3. Deploy Database Pods\nkubectl apply -f ./k8s/deployment.yaml\n\n# 4. Expose Internal Service\nkubectl apply -f ./k8s/service.yaml\n</code></pre> <p>Creating Custom Secrets To manually create a secret (e.g., for JWT signing): </p><pre><code>kubectl create secret generic auth-secrets \\\n  --from-literal=JWT_SECRET_KEY=\"your_super_secret_key_here\"\n</code></pre><p></p>"},{"location":"k8s/kubernetes/#2-service-deployment","title":"2\ufe0f\u20e3 Service Deployment","text":"<p>(Account, Auth, Product, Order, Gateway)</p> <p>Each service follows a standard deployment pattern:</p> <pre><code># Apply all manifests in the k8s directory\nkubectl apply -f ./k8s/k8s.yaml\n\n# Verify Status\nkubectl get deployments\nkubectl get pods\nkubectl get services\n</code></pre>"},{"location":"k8s/kubernetes/#verification","title":"\ud83d\udd0d Verification","text":"<p>Check the status of all resources in the namespace:</p> <pre><code>kubectl get all\n</code></pre>"},{"location":"order/order/","title":"Order","text":""},{"location":"order/order/#order-service","title":"Order Service","text":"<p>The Order Service handles the lifecycle of customer orders. It allows authenticated users to place orders, automatically validating product availability and calculating totals. It acts as an orchestrator, communicating with the Product Service to retrieve item details.</p> <p>Protected Resource</p> <ul> <li>User Context: All operations require a valid user context. The Gateway injects the <code>id-account</code> header, which the service uses to link orders to the correct user.</li> </ul>"},{"location":"order/order/#architecture","title":"\ud83c\udfd7\ufe0f Architecture","text":"<p>The service manages a complex object graph (Orders containing Items) and integrates with external services.</p> <pre><code>classDiagram\n    namespace Interface_Layer {\n        class OrderController {\n            +create(String accountId, OrderIn): OrderOut\n            +findById(String accountId, String): OrderOut\n            +findAll(String accountId): List~OrderOut~\n        }\n        class OrderIn {\n            +List~OrderItemIn~ items\n        }\n        class OrderOut {\n            +String id\n            +String date\n            +Double total\n            +List~OrderItemOut~ items\n        }\n    }\n    namespace Core_Layer {\n        class OrderService {\n            +create(OrderIn, String): OrderOut\n            +findAll(String): List~OrderOut~\n        }\n        class OrderRepository {\n            +save(OrderModel): OrderModel\n            +findAllByAccountId(String): List~OrderModel~\n        }\n    }\n    namespace External_Integration {\n        class ProductClient {\n            +findById(String): ProductOut\n        }\n    }\n\n    OrderController --&gt; OrderService : delegates\n    OrderService --&gt; OrderRepository : persists\n    OrderService --&gt; ProductClient : verifies products</code></pre>"},{"location":"order/order/#api-reference","title":"\ud83d\udd0c API Reference","text":""},{"location":"order/order/#endpoints","title":"Endpoints","text":"Method Path Description Headers Required <code>POST</code> <code>/order</code> Create a new order. <code>id-account</code> <code>GET</code> <code>/order</code> List all orders for the user. <code>id-account</code> <code>GET</code> <code>/order/{id}</code> Retrieve order details. <code>id-account</code>"},{"location":"order/order/#data-models","title":"Data Models","text":""},{"location":"order/order/#orderin-input","title":"<code>OrderIn</code> (Input)","text":"<pre><code>{\n  \"items\": [\n    {\n      \"productId\": \"123e4567-e89b-12d3-a456-426614174000\",\n      \"quantity\": 2\n    }\n  ]\n}\n</code></pre>"},{"location":"order/order/#orderout-output","title":"<code>OrderOut</code> (Output)","text":"<pre><code>{\n  \"id\": \"789e4567-e89b-12d3-a456-426614174999\",\n  \"date\": \"2025-11-29T10:00:00\",\n  \"total\": 199.98,\n  \"items\": [\n    {\n      \"productId\": \"123e4567-e89b-12d3-a456-426614174000\",\n      \"quantity\": 2,\n      \"total\": 199.98,\n      \"product\": { ... } // Expanded product details\n    }\n  ]\n}\n</code></pre>"},{"location":"order/order/#business-logic","title":"\ud83e\udde0 Business Logic","text":"<p>The <code>OrderService</code> orchestrates the order creation process.</p>"},{"location":"order/order/#order-creation-flow","title":"Order Creation Flow","text":"<ol> <li>Validate Input: Ensures the order contains items.</li> <li>Fetch Products: Calls the Product Service for each item to verify existence and retrieve current prices.</li> <li>Calculate Totals:<ul> <li>Item Total = <code>Product Price * Quantity</code></li> <li>Order Total = Sum of Item Totals</li> </ul> </li> <li>Persist: Saves the Order and its Items to the database in a single transaction.</li> </ol> <pre><code>// Snippet from OrderService.java\n@Transactional\npublic OrderOut create(OrderIn in, String idAccount) {\n    // ... validation ...\n    double orderTotal = 0.0;\n    for (int i = 0; i &lt; in.items().size(); i++) {\n        // ... fetch product ...\n        double total = product.price() * inItem.quantity();\n        // ... create item model ...\n        orderTotal += total;\n    }\n    om.setTotal(orderTotal);\n    return OrderParser.toOut(orderRepository.save(om), products);\n}\n</code></pre>"},{"location":"order/order/#database-schema","title":"\ud83d\udcbe Database Schema","text":"<p>The service uses PostgreSQL with a dedicated schema (<code>\"order\"</code>). Note the quoted schema name to avoid conflict with the SQL keyword <code>ORDER</code>.</p>"},{"location":"order/order/#table-orders","title":"Table: <code>orders</code>","text":"Column Type Description <code>id</code> <code>VARCHAR</code> Primary Key. <code>date</code> <code>TIMESTAMP</code> Order creation date. <code>account_id</code> <code>VARCHAR</code> ID of the user who placed the order. <code>total</code> <code>DOUBLE</code> Total value of the order."},{"location":"order/order/#table-item","title":"Table: <code>item</code>","text":"Column Type Description <code>id</code> <code>VARCHAR</code> Primary Key. <code>order_id</code> <code>VARCHAR</code> Foreign Key to <code>orders</code>. <code>product_id</code> <code>VARCHAR</code> ID of the product. <code>quantity</code> <code>INTEGER</code> Quantity purchased. <code>total</code> <code>DOUBLE</code> Total price for this line item."},{"location":"order/order/#configuration","title":"\u2699\ufe0f Configuration","text":"<p>The service is configured via <code>application.yml</code>.</p> <pre><code>spring:\n  application:\n    name: order\n  datasource:\n    url: ${DATABASE_URL}\n  jpa:\n    properties:\n      hibernate:\n        default_schema: order # Explicit schema definition\n</code></pre>"},{"location":"order/order/#project-structure","title":"\ud83d\udcc2 Project Structure","text":"<p>The project is split into two modules:</p> <ol> <li>Interface (<code>order</code>): Contains DTOs and Feign Client.</li> <li>Implementation (<code>order.service</code>): The Spring Boot application.</li> </ol> <pre><code>\ud83d\udcc1 api/\n \u251c\u2500\u2500 order/                  # Interface Module\n \u2502   \u251c\u2500\u2500 src/main/java/store/order/\n \u2502   \u2502   \u251c\u2500\u2500 OrderController.java    # Feign Client\n \u2502   \u2502   \u251c\u2500\u2500 OrderIn.java            # DTO\n \u2502   \u2502   \u2514\u2500\u2500 OrderOut.java           # DTO\n \u2502   \u2514\u2500\u2500 pom.xml\n \u2502\n\ud83d\udcc1 \u2514\u2500\u2500 order.service/          # Implementation Module\n\u251c\u2500\u2500  \u251c\u2500\u2500 src/main/java/store/order/\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 OrderService.java       # Business Logic\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 OrderResource.java      # REST Controller\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 OrderRepository.java    # JPA Repository\n\u251c\u2500\u2500  \u2502   \u2514\u2500\u2500 OrderModel.java         # JPA Entity\n\u251c\u2500\u2500  \u251c\u2500\u2500 src/main/resources/\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 db/migration/           # Flyway Scripts\n\u251c\u2500\u2500  \u2502   \u2514\u2500\u2500 application.yml         # Config\n\u251c\u2500\u2500  \u251c\u2500\u2500 Dockerfile\n\u2514\u2500\u2500  \u2514\u2500\u2500 k8s/                        # Kubernetes Manifests\n</code></pre>"},{"location":"product/product/","title":"Product","text":""},{"location":"product/product/#product-service","title":"Product Service","text":"<p>The Product Service manages the catalog of items available in the store. It provides a CRUD (Create, Read, Update, Delete) interface for managing product details such as name, price, and unit.</p> <p>Protected Resource</p> <ul> <li>Access Control: All modification endpoints (POST, DELETE) require authentication.</li> <li>Public Access: Read-only endpoints (GET) are generally accessible but may be restricted by the Gateway configuration.</li> </ul>"},{"location":"product/product/#architecture","title":"\ud83c\udfd7\ufe0f Architecture","text":"<p>The service follows a standard layered architecture with a clean separation between the API contract and the persistence layer.</p> <pre><code>classDiagram\n    namespace Interface_Layer {\n        class ProductController {\n            +create(ProductIn): ProductOut\n            +findById(String): ProductOut\n            +findAll(): List~ProductOut~\n            +delete(String): void\n        }\n        class ProductIn {\n            +String name\n            +Double price\n            +String unit\n        }\n        class ProductOut {\n            +String id\n            +String name\n            +Double price\n            +String unit\n        }\n    }\n    namespace Core_Layer {\n        class ProductService {\n            +create(Product): Product\n            +findAll(): List~Product~\n            +delete(String): void\n        }\n        class ProductRepository {\n            +save(ProductModel): ProductModel\n            +findById(String): Optional~ProductModel~\n        }\n    }\n\n    ProductController --&gt; ProductService : delegates\n    ProductService --&gt; ProductRepository : persists</code></pre>"},{"location":"product/product/#api-reference","title":"\ud83d\udd0c API Reference","text":""},{"location":"product/product/#endpoints","title":"Endpoints","text":"Method Path Description <code>POST</code> <code>/product</code> Create a new product. <code>GET</code> <code>/product</code> List all products. <code>GET</code> <code>/product/{id}</code> Retrieve product details. <code>GET</code> <code>/product/search/{name}</code> Search products by name. <code>DELETE</code> <code>/product/{id}</code> Delete a product."},{"location":"product/product/#data-models","title":"Data Models","text":""},{"location":"product/product/#productin-input","title":"<code>ProductIn</code> (Input)","text":"<pre><code>{\n  \"name\": \"Smartphone X\",\n  \"price\": 999.99,\n  \"unit\": \"un\"\n}\n</code></pre>"},{"location":"product/product/#productout-output","title":"<code>ProductOut</code> (Output)","text":"<pre><code>{\n  \"id\": \"123e4567-e89b-12d3-a456-426614174000\",\n  \"name\": \"Smartphone X\",\n  \"price\": 999.99,\n  \"unit\": \"un\"\n}\n</code></pre>"},{"location":"product/product/#business-logic","title":"\ud83e\udde0 Business Logic","text":"<p>The <code>ProductService</code> enforces data integrity rules before persistence.</p>"},{"location":"product/product/#validation-rules","title":"Validation Rules","text":"<ul> <li>Name: Mandatory and must be unique. Special characters are trimmed.</li> <li>Price: Mandatory.</li> <li>Unit: Mandatory.</li> </ul> <pre><code>// Snippet from ProductService.java\npublic Product create(Product product) {\n    if (null == product.name()) {\n        throw new ResponseStatusException(HttpStatus.BAD_REQUEST, \"Name is mandatory!\");\n    }\n    // Check for duplicates\n    if (productRepository.findByName(product.name()).isPresent()) {\n        throw new ResponseStatusException(HttpStatus.BAD_REQUEST, \"Name already have been registered!\");\n    }\n    // ...\n}\n</code></pre>"},{"location":"product/product/#database-schema","title":"\ud83d\udcbe Database Schema","text":"<p>The service uses PostgreSQL for persistence, managed by Flyway.</p>"},{"location":"product/product/#table-product","title":"Table: <code>product</code>","text":"Column Type Constraints Description <code>id</code> <code>VARCHAR</code> <code>PRIMARY KEY</code> Unique UUID. <code>name</code> <code>VARCHAR</code> <code>NOT NULL</code> Product name. <code>price</code> <code>DOUBLE</code> <code>NOT NULL</code> Product price. <code>unit</code> <code>VARCHAR</code> <code>NOT NULL</code> Unit of measurement (e.g., 'kg', 'un')."},{"location":"product/product/#migrations","title":"Migrations","text":"<ul> <li><code>V2025.08.29.001__create_schema.sql</code>: Initializes the schema.</li> <li><code>V2025.08.29.002__create_table_product.sql</code>: Creates the product table.</li> </ul>"},{"location":"product/product/#configuration","title":"\u2699\ufe0f Configuration","text":"<p>The service is configured via <code>application.yml</code>.</p> <pre><code>spring:\n  application:\n    name: product\n  datasource:\n    url: ${DATABASE_URL}\n    username: ${DATABASE_USERNAME}\n    password: ${DATABASE_PASSWORD}\n  flyway:\n    schemas: product\n</code></pre>"},{"location":"product/product/#project-structure","title":"\ud83d\udcc2 Project Structure","text":"<p>The project is split into two modules:</p> <ol> <li>Interface (<code>product</code>): Contains DTOs and Feign Client.</li> <li>Implementation (<code>product.service</code>): The Spring Boot application.</li> </ol> <pre><code>\ud83d\udcc1 api/\n \u251c\u2500\u2500 product/                # Interface Module\n \u2502   \u251c\u2500\u2500 src/main/java/store/product/\n \u2502   \u2502   \u251c\u2500\u2500 ProductController.java  # Feign Client\n \u2502   \u2502   \u251c\u2500\u2500 ProductIn.java          # Input DTO\n \u2502   \u2502   \u2514\u2500\u2500 ProductOut.java         # Output DTO\n \u2502   \u2514\u2500\u2500 pom.xml\n \u2502\n\ud83d\udcc1 \u2514\u2500\u2500 product.service/        # Implementation Module\n\u251c\u2500\u2500  \u251c\u2500\u2500 src/main/java/store/product/\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 ProductService.java     # Business Logic\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 ProductResource.java    # REST Controller\n\u251c\u2500\u2500  \u2502   \u2514\u2500\u2500 ProductRepository.java  # JPA Repository\n\u251c\u2500\u2500  \u251c\u2500\u2500 src/main/resources/\n\u251c\u2500\u2500  \u2502   \u251c\u2500\u2500 db/migration/           # Flyway Scripts\n\u251c\u2500\u2500  \u2502   \u2514\u2500\u2500 application.yml         # Config\n\u251c\u2500\u2500  \u251c\u2500\u2500 Dockerfile\n\u2514\u2500\u2500  \u2514\u2500\u2500 k8s/                        # Kubernetes Manifests\n</code></pre>"}]}